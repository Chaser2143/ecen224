<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="">

<title>
    
    Image • ECEn 224: Intro to Computer Systems
    
</title>

<!-- Bootstrap core CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
    integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">

<!-- Custom styles for this template -->
<link rel="stylesheet" href=/ecen224/css/main.css>

<!-- <link href="https://fonts.googleapis.com/css?family=Ubuntu&display=swap" rel="stylesheet"> -->
<!-- <link href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono&display=swap" rel="stylesheet"> -->
<link rel="stylesheet" href="https://use.typekit.net/jcn6ybb.css">

<link rel="icon" type="image/png" sizes="96x96" href=/ecen224/icon/favicon-96x96.png>
<link rel="icon" type="image/png" sizes="32x32" href=/ecen224/icon/favicon-32x32.png>
<link rel="icon" type="image/png" sizes="16x16" href=/ecen224/icon/favicon-16x16.png>

<script src="https://kit.fontawesome.com/624d595ebf.js" crossorigin="anonymous"></script>


</head>

<body>
  <div class="d-flex" id="wrapper">
    <!-- Sidebar -->
<div class="border-right" id="sidebar-wrapper">
    <div class="sidebar-sticky">
        <div class="sidebar-heading-big">
            <a href="/ecen224/"><img src="/ecen224/icon/icon.svg">
                ECEn 224</a>
        </div>

        <div class="list-group list-group-flush">
            
            <!-- Look for specific front-matter tag -->
            
            <a href="/ecen224/overview/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-chalkboard-teacher"></i>
                
                Overview
            </a>
            
            
            <!-- Look for specific front-matter tag -->
            
            <a href="/ecen224/resources/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-book"></i>
                
                Resources
            </a>
            
            
            <!-- Look for specific front-matter tag -->
            
            <a href="/ecen224/coding-standard/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-terminal"></i>
                
                Coding Standard
            </a>
            
            
            <!-- Look for specific front-matter tag -->
            
            <a href="/ecen224/lab-setup/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-wrench"></i>
                
                Lab Setup
            </a>
            
            
            <!-- Look for specific front-matter tag -->
            
            <a href="https://learningsuite.byu.edu/.N7cA/cid-qWPtDGbD9Vq6/calendar" class="list-group-item list-group-item-action sidebar-item" target="_blank" rel="noopener noreferrer">
                
                <i class="fa-duotone fa-calendar"></i>
                
                Schedule
            </a>
            
            
        </div>

        <div class="sidebar-heading">Labs</div>
        <div class="list-group list-group-flush">
            
            <a href="/ecen224/labs/getting-started/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">1</span>
                Getting Started
            </a>
            
            <a href="/ecen224/labs/command-line/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">2</span>
                Command Line
            </a>
            
            <a href="/ecen224/labs/data/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">3</span>
                Data
            </a>
            
            <a href="/ecen224/labs/image/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">4</span>
                Image
            </a>
            
            <a href="/ecen224/labs/debugging/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">5</span>
                Debugging
            </a>
            
            <a href="/ecen224/labs/display/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">6</span>
                Display
            </a>
            
            <a href="/ecen224/labs/io/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">7</span>
                I/O
            </a>
            
            <a href="/ecen224/labs/camera/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">8</span>
                Camera
            </a>
            
            <a href="/ecen224/labs/client/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">9</span>
                Client
            </a>
            
            <a href="/ecen224/labs/threaded-client/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">10</span>
                Threaded Client
            </a>
            
            <a href="/ecen224/labs/doorbell/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">11</span>
                Doorbell
            </a>
            
        </div>

        <div class="sidebar-heading">Programming Assignments</div>
        <div class="list-group list-group-flush">
            
            <a href="/ecen224/programming-assignments/bomb-lab/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-bomb"></i>
                
                Bomb Lab
            </a>
            
            <a href="/ecen224/programming-assignments/attack-lab/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-bow-arrow"></i>
                
                Attack Lab
            </a>
            
        </div>

        <div class="sidebar-heading">Homeworks</div>
        <div class="list-group list-group-flush">
            
            <a href="/ecen224/homework/data/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-binary"></i>
                
                Data
            </a>
            
            <a href="/ecen224/homework/c/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-brackets-curly"></i>
                
                C
            </a>
            
            <a href="/ecen224/homework/assembly/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-microchip"></i>
                
                Assembly
            </a>
            
            <a href="/ecen224/homework/memory/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-memory"></i>
                
                Memory
            </a>
            
            <a href="/ecen224/homework/io/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-server"></i>
                
                I/O
            </a>
            
        </div>
    </div>
</div>
<!-- /#sidebar-wrapper -->


    <!-- Page Content -->
    <div id="page-content-wrapper">

      <nav class="navbar sticky-top navbar-expand-lg border-bottom">
    <button class="btn btn-brand" id="menu-toggle">
        <i class="fas fa-bars"></i>
    </button>

    <a href="#" class="navbar-brand mb-0 h1 page-title-bar text-center mx-auto" id="page-title-bar"></a>

    
    <ul class="navbar-nav">
        <li class="nav-item">
            <a class="nav-link btn btn-brand suggest-edits" target="_blank" rel="noopener noreferrer" href="https://github.com/byu-cpe/ecen224/issues/new?title=Suggestions+for+Image+Page"><i class="fab fa-github"></i> Suggest
                Edits</a>
        </li>
    </ul>
    
</nav>


      <div class="container">
        <article class="page lab">
    <h1 class="page-title" id="page-title">
        Image
    </h1>

    <div class="page-content">
        
        <div class="lab-toc col-md-6 col-lg-5">
            <h4>Table of Contents</h4>
            <ul>
  <li><a href="#github-classroom">GitHub Classroom</a></li>
  <li><a href="#objectives">Objectives</a></li>
  <li>
<a href="#overview">Overview</a>
    <ul>
      <li><a href="#bitmap-struct">Bitmap Struct</a></li>
      <li><a href="#bitmasking">Bitmasking</a></li>
      <li>
<a href="#pixel-values-in-bmp-file">Pixel Values in BMP file</a>
        <ul>
          <li><a href="#important-warning-about-bmp-rows">Important warning about BMP rows:</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
<a href="#requirements">Requirements</a>
    <ul>
      <li><a href="#remove-color-channel">Remove Color Channel</a></li>
      <li><a href="#or-blur">OR Blur</a></li>
    </ul>
  </li>
  <li><a href="#submission">Submission</a></li>
  <li><a href="#explore-more">Explore More!</a></li>
</ul>

        </div>
        

        <h2 id="github-classroom">GitHub Classroom</h2>
<p>Use the GitHub Classroom link posted in the Slack channel for the lab to accept the assignment.</p>

<h2 id="objectives">Objectives</h2>

<ul>
  <li>Gain experience with manipulating bytes in C by modifying image files</li>
  <li>Learn how to use <code class="language-plaintext highlighter-rouge">enum</code> values</li>
  <li>Learn the structure of a multi-file C program (.h and .c files)</li>
  <li>Get more practice with compilation of a program by using <code class="language-plaintext highlighter-rouge">gcc</code>
</li>
</ul>

<h2 id="overview">Overview</h2>

<figure class="image mx-auto" style="max-width: 750px">
  <img src="/ecen224/assets/image/original.bmp" alt="Units of the course.">
  <figcaption style="text-align: center;">Original bitmap image that you will be editing in the lab.</figcaption>
</figure>

<p>In this lab we will be exploring the utility of data manipulation in a practical application by editing an image in C. <strong>This lab will be programming heavy</strong> and a little more involved than previous labs. <strong>Make sure you allow yourself enough time to complete this lab.</strong></p>

<h3 id="bitmap-struct">Bitmap Struct</h3>
<p>Unlike other programming languages that you may be familiar with, the C programming language is not an object oriented programming language. This means that there are no <code class="language-plaintext highlighter-rouge">class</code> objects that allow you to associate groups of data together.</p>

<p>To accomplish this, C uses a the <code class="language-plaintext highlighter-rouge">struct</code> object, which is actually a predecessor to the <code class="language-plaintext highlighter-rouge">class</code> object we see in most programs. Below is the <code class="language-plaintext highlighter-rouge">struct</code> included in the <code class="language-plaintext highlighter-rouge">image.h</code> library in the code for this lab:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
    <span class="kt">FILE</span> <span class="o">*</span> <span class="n">img</span><span class="p">;</span>
    <span class="kt">uint8_t</span> <span class="n">file_header</span><span class="p">[</span><span class="n">BMP_FILE_HEADER_SIZE</span><span class="p">];</span>  <span class="c1">// 14 bytes</span>
    <span class="kt">uint8_t</span> <span class="o">*</span> <span class="n">dib_header</span><span class="p">;</span>                       <span class="c1">// Variable</span>
    <span class="kt">uint8_t</span> <span class="o">*</span> <span class="n">pxl_data</span><span class="p">;</span>                         <span class="c1">// Pixel data for image</span>
    <span class="kt">uint8_t</span> <span class="o">*</span> <span class="n">pxl_data_cpy</span><span class="p">;</span>                     <span class="c1">// Copy of pixel data</span>
    <span class="kt">uint8_t</span> <span class="n">pxl_data_offset</span><span class="p">;</span>                    <span class="c1">// Location of pxl data in img</span>
    <span class="kt">uint32_t</span> <span class="n">img_width</span><span class="p">;</span>                         <span class="c1">// Image width</span>
    <span class="kt">uint32_t</span> <span class="n">img_height</span><span class="p">;</span>                        <span class="c1">// Image height</span>
    <span class="kt">uint32_t</span> <span class="n">file_size</span><span class="p">;</span>                         <span class="c1">// Size of the file</span>
    <span class="kt">uint32_t</span> <span class="n">pxl_data_size</span><span class="p">;</span>                     <span class="c1">// Size of pixel data array</span>
<span class="p">}</span> <span class="n">Bitmap</span><span class="p">;</span>
</code></pre></div></div>

<p>Much like a <code class="language-plaintext highlighter-rouge">class</code>, a <code class="language-plaintext highlighter-rouge">struct</code> is a collection of different variable values all associated with the same process. In the <code class="language-plaintext highlighter-rouge">Bitmap struct</code> we see many properties associated with the file, including:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">pxl_data</code>: This is a one dimensional list of <code class="language-plaintext highlighter-rouge">uint8_t</code> values that represent pixel values in the image.</li>
  <li>
<code class="language-plaintext highlighter-rouge">pxl_data_cpy</code>: This is a copy of the list of <code class="language-plaintext highlighter-rouge">uint8_t</code> values that represent pixel values in the image. This will be helpful with some of the algorithms later on in the lab.</li>
  <li>
<code class="language-plaintext highlighter-rouge">img_width</code>: Number of pixels in each row in the image.</li>
  <li>
<code class="language-plaintext highlighter-rouge">img_height</code>: Number of rows of pixels in the image.</li>
  <li>
<code class="language-plaintext highlighter-rouge">pxl_data_size</code>: Size (in bytes) of <code class="language-plaintext highlighter-rouge">pxl_data</code>.</li>
</ul>

<h3 id="bitmasking">Bitmasking</h3>
<p>Bitmasking is is a method that allows us to manipulate (set to 1 or 0) certain bits of data. This is done general by making use of bitwise ORs, ANDs, and XORs.</p>

<p>For example if we wanted to select nothing but the last two bits of the byte (in binary) <code class="language-plaintext highlighter-rouge">11101011</code> we would use AND with a 0 on all the values we don’t want and a 1 on all the values we do want in our selection:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     11101011
AND  00000011   &lt;--- This value is known as the 'mask'
-------------
     00000011   &lt;--- The masked value
</code></pre></div></div>
<p>although this is most obvious when representing the numbers as binary, the masking principles work for any representation of numbers.</p>

<p>If we wanted to recreate the following operation in C with hexademical numbers, it would be the following:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">uint8_t</span> <span class="n">number</span> <span class="o">=</span> <span class="mh">0xEB</span><span class="p">;</span>
<span class="kt">uint8_t</span> <span class="n">mask</span>   <span class="o">=</span> <span class="mh">0x03</span><span class="p">;</span>

<span class="c1">// Mask the numbers</span>
<span class="n">number</span> <span class="o">=</span> <span class="n">number</span> <span class="o">&amp;</span> <span class="n">mask</span><span class="p">;</span> <span class="c1">// number = 0x03</span>
</code></pre></div></div>

<h3 id="pixel-values-in-bmp-file">Pixel Values in BMP file</h3>
<p>The data you will be manipulating in this lab are the color channels of a pixel in a bitmap (or BMP) file. Each pixel is represented by three groups of colors: <code class="language-plaintext highlighter-rouge">BLUE</code>, <code class="language-plaintext highlighter-rouge">GREEN</code>, and <code class="language-plaintext highlighter-rouge">RED</code>:</p>

<figure class="image mx-auto" style="max-width: 750px">
  <img src="/ecen224/assets/image/pixels.png" alt="Units of the course.">
  <figcaption style="text-align: center;">This is how color values are stored in the BMP. In image processing, a row of these pixels is also called a stride.</figcaption>
</figure>

<p>Different values of a color channels will provide different hues and shades of colors. If that isn’t making too much sense, there is a wonderful visualation of how different color channels create different pixel colors <a href="https://www.w3schools.com/colors/colors_picker.asp" target="_blank" rel="noopener noreferrer">here</a>.</p>

<p>Each color channel is exactly 8 bits long (or one byte). Look at the <code class="language-plaintext highlighter-rouge">pxl_data</code> field in the <code class="language-plaintext highlighter-rouge">Bitmap</code> struct shown above. What type does it use? (Feel free to ignore the star).</p>

<p>While creating the algorithms below, keep in mind that the values are stored as color channels and <strong>NOT pixels</strong>.</p>

<p>Specifically in the BMP file, the values begin from the bottom left and fill up the row right to left and fill up the screen bottom to top.</p>

<h4 id="important-warning-about-bmp-rows">Important warning about BMP rows:</h4>
<p>In BMPs, the rows <strong>MUST</strong> be multiples of 4 bytes. This means if the image has a width that is not a multiple of 4, the BMP file employs padding to fufill that requirement.</p>

<p>While you are not responsible of adding this padding, you will need to take into account that you loop over each row applying the following algorithms. The easiest way to do this is to round up your loop limit to the nearest factor of 4.</p>

<h2 id="requirements">Requirements</h2>
<p>In the code provided in this lab, you will be expected to edit the original image listed at the top of this page to provide some fun visual effects!</p>

<p>Much of the code has been given for you, but you are expected to follow the comments in the files and fill in logic for both the <code class="language-plaintext highlighter-rouge">remove_color_channel()</code> function and the <code class="language-plaintext highlighter-rouge">or_blur()</code> function.</p>

<h3 id="remove-color-channel">Remove Color Channel</h3>
<p>In this function, you are expected to create logic that will allow a user to specify a color channel and have that color removed completely from the image. As you can see in the figures below, each image has either the red, green, or blue values set to 0.</p>

<figure class="image mx-auto" style="max-width: 750px">
  <img src="/ecen224/assets/image/red_mask.bmp" alt="Units of the course.">
  <figcaption style="text-align: center;">Original.bmp with all of the red values masked out.</figcaption>
</figure>

<figure class="image mx-auto" style="max-width: 750px">
  <img src="/ecen224/assets/image/green_mask.bmp" alt="Units of the course.">
  <figcaption style="text-align: center;">Original.bmp with all of the green values masked out.</figcaption>
</figure>

<figure class="image mx-auto" style="max-width: 750px">
  <img src="/ecen224/assets/image/blue_mask.bmp" alt="Units of the course.">
  <figcaption style="text-align: center;">Original.bmp with all of the blue values masked out.</figcaption>
</figure>

<p>These images are the answer to your function! If you have done it correctly, your output should look exactly like whats above.</p>

<h3 id="or-blur">OR Blur</h3>

<p>This function will be the culmination of your data manipulation knowledge that you have learned up until now. In this function you will take each color channel value and bitwise OR it with the value directly above and below it.</p>

<p>Make sure to use the <code class="language-plaintext highlighter-rouge">pxl_data_cpy</code> list as your values that you are changing inside of your <code class="language-plaintext highlighter-rouge">pxl_data</code> list. If you use the <code class="language-plaintext highlighter-rouge">pxl_data</code> as your reference data, you will have compounding effects that will cause the image to be indistinguishable. This is not correct.</p>

<h2 id="submission">Submission</h2>

<ul>
  <li>
    <p>Answer the questions in the <code class="language-plaintext highlighter-rouge">README.md</code>.</p>
  </li>
  <li>
    <p>To successfully submit your lab, you will need to follow the instructions in the <a href="/ecen224/lab-setup">Lab Setup</a> page, especially the <strong>Commiting and Pushing Files</strong> and <strong>Tagging Submissions</strong> section.</p>
  </li>
</ul>

<h2 id="explore-more">Explore More!</h2>

<ul>
  <li><a href="https://en.wikipedia.org/wiki/Bitwise_operations_in_C" target="_blank" rel="noopener noreferrer">Bitwise Operations in C</a></li>
  <li><a href="https://en.wikipedia.org/wiki/Mask_(computing)" target="_blank" rel="noopener noreferrer">Bit Masking</a></li>
  <li><a href="https://www.tutorialspoint.com/cprogramming/c_structures.htm" target="_blank" rel="noopener noreferrer">Struct in C</a></li>
  <li><a href="https://www.tutorialspoint.com/enum-in-c" target="_blank" rel="noopener noreferrer">Enum in C</a></li>
</ul>

    </div>
</article>
      </div>
    </div>
    <!-- /#page-content-wrapper -->

  </div>
  <!-- /#wrapper -->

  <!-- Bootstrap core JavaScript -->
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
<script src="/ecen224/js/jquery.visible.min.js"></script>

<!-- Menu Toggle Script -->
<script>
    $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });

    var prevVisible = $('#page-title').visible();

    $(window).scroll(function () {
        currentVisible = $('#page-title').visible()
        if (prevVisible && !currentVisible) {
            console.log("Do something!");
            $("#page-title-bar").html($('#page-title').text());
        }

        if (!prevVisible && currentVisible) {
            $("#page-title-bar").html("")
        }

        prevVisible = currentVisible;
    });

</script>

</body>

</html>